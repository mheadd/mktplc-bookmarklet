var Cookie=function(a){this.cookie=function(c,b,d){if(void 0!==b)a.db.set(c,b,d);else return a.db.get(c)};this.cookie.list=function(){return a.db.list()};this.cookie.remove=function(c){a.db.remove(c)};this.cookie.removeAll=function(){a.db.removeAll()};this.cookie.get=function(c,b,d,e,f){a.db.setFromRemote(c,b,d,e,f)};a.mysite={cookie:function(c,b,d){if(void 0!==a.manifest.domain&&null!==a.manifest.domain){var e=(new Date).getTime();if(void 0!==b)void 0===d||d>e?(d=void 0===d?(new Date(2030,1,1,0,
0,0,0)).getTime():d.getTime(),"undefined"!==typeof Crossrider?Crossrider.setRealCookie(c,b,d):(a.updateRealCookie(c,{value:b,expires:d}),chrome.extension.sendRequest({action:"setRealCookie",params:[c,b,d,a.tabID]},function(){}))):"undefined"!==typeof Crossrider?Crossrider.unsetRealCookie(c):(a.unsetRealCookie(c),chrome.extension.sendRequest({action:"unsetRealCookie",params:[c]},function(){}));else return b=(c=a._cookies.mysite[c])?c.expires:null,null!==b&&"number"!==typeof b&&(b=(new Date(b)).getTime()),
c&&(null===b||b>e)?c.value:null}}};return this.cookie},DB={init:function(a){this._self=a;for(var c in this._self._cookies)if(this._self._cookies.hasOwnProperty(c)&&"mysite"!==c&&(a=this._self._cookies[c],"number"!==typeof a.expires))a.expires=(new Date(a.expires)).getTime();return this},get:function(a){if("mysite"===a)throw"mysite is a reserved name";var c=(new Date).getTime(),b=this._self._cookies[a];if(b&&b.expires>c)return b.value;b&&this.remove(a);return null},set:function(a,c,b){if("mysite"===
a)throw"mysite is a reserved name";var d=(new Date).getTime();void 0===b||b>d?(b=void 0===b?(new Date(2030,1,1,0,0,0,0)).getTime():b.getTime(),this._self.updateCookie(a,{value:c,expires:b}),"undefined"!==typeof Crossrider?Crossrider.setCookie(a,c,b):chrome.extension.sendRequest({action:"setCookie",params:[a,c,b,this._self.tabID]},function(){})):this.remove(a)},list:function(){var a={},c;for(c in this._self._cookies)if(this._self._cookies.hasOwnProperty(c)&&"mysite"!==c){var b=this.get(c);null!==b&&
(a[c]=b)}return a},remove:function(a){this._self.unsetCookie(a);"undefined"!==typeof Crossrider?Crossrider.unsetCookie(a):chrome.extension.sendRequest({action:"unsetCookie",params:[a]},function(){})},removeAll:function(){for(var a in this._self._cookies)this._self._cookies.hasOwnProperty(a)&&this.remove(a)},setFromRemote:function(a,c,b,d,e){b instanceof Date||(b=new Date(2030,1,1,0,0,0,0));var f=(new Date).getTime();b.getTime()>f?this._self.request.get(a,function(a){a=a.replace(/[\r\t\n]+/gi,"").replace(/>\s+</gi,
"><").replace(/\s{2}/gi," ");d&&d(a);this.set(c,a,b)}.bind(this),function(a){e&&e(a)}):(this.remove(c),d&&d(!1))}};
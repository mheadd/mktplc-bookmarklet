var FBBridge={_params:{},_dom:{},_connected:!1,transparent:!1,init:function(a,d,b){this._params.useCrossriderSupport=!0;this._params.appID=d;this.transparent=b;this._params.fb_baseurl="http://app"+this._params.appID+".crossrider.com/fb";if(a&&-1<a.indexOf("http"))this._params.useCrossriderSupport=!1,this._params.fb_baseurl=a+"?appid="+this._params.appID+"&aid="+this._params.appID;this._dom.container=document.createElement("div");this._dom.container.setAttribute("style","position:absolute;top:-1000px");
document.body.appendChild(this._dom.container);window.addEventListener("message",this.handleFacebookCallback.bind(this),!1);return this},handleFacebookCallback:function(a){var d=a.origin,b=a.data,e=this.getActionID(b.action,b.tabId),c=this;if(0===this._params.fb_baseurl.indexOf(d))if(this.transparent){this._dom.container.innerHTML="";if("close_invite_window"===b.action)b.action="invite";appAPI.fbAPI.callback(b.action,b.response);c.removeIframe(e)}else null===b.tabId?chrome.tabs.getSelected(null,function(a){a?
chrome.tabs.sendRequest(a.id,{action:"fb_respond",params:[b.action,b.response]},function(){c.removeIframe(e)}):c.removeIframe(e)}):chrome.tabs.get(parseInt(b.tabId),function(a){a?chrome.tabs.sendRequest(a.id,{action:"fb_respond",params:[b.action,b.response]},function(){c.removeIframe(e)}):c.removeIframe(e)})},generateUrl:function(a,d,b){return this._params.useCrossriderSupport?this._params.fb_baseurl+"/"+a+"?appid="+this._params.appID+"&tid="+b+d:this._params.fb_baseurl+"&api="+a+"&tid="+b+d},hash_to_params:function(a){var d=
["&"],b;for(b in a)d.push(b+"="+escape(a[b]));return d.join("&")},exec:function(a,d,b){var e=this.getActionID(d,a),b=b?this.hash_to_params(b):"",a=this.generateUrl(d,b,a);this.removeIframe(e);var c=document.createElement("iframe");c.setAttribute("id",e);c.setAttribute("src",a);c.setAttribute("allowtransparency","true");c.setAttribute("frameborder","0");c.setAttribute("width","10");c.setAttribute("height","10");this._dom.container.appendChild(c);this.transparent&&(c.setAttribute("style","position:fixed !important; top:0 !important;left:0 !important; border:0 !important; width:99% !important; height:100% !important; z-index:99999 !important;visibility:hidden"),
jQuery(c).load(function(){c.style.visibility="visible"}))},removeIframe:function(a){(a=document.getElementById(a))&&this._dom.container.removeChild(a)},getActionID:function(a,d){return["crossrider",a,"iframe",this._params.appID,d].join("-")}};